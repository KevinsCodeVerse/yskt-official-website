{"ast":null,"code":"import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array-buffer.constructor.js\";\nimport \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.data-view.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.typed-array.uint8-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.find-last.js\";\nimport \"core-js/modules/es.typed-array.find-last-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.subarray.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/web.atob.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.dom-exception.constructor.js\";\nimport \"core-js/modules/web.dom-exception.stack.js\";\nimport \"core-js/modules/web.dom-exception.to-string-tag.js\";\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nimport { QiniuErrorName, QiniuError } from '../errors';\nimport { createObjectURL } from './helper';\nvar mimeTypes = {\n  PNG: 'image/png',\n  JPEG: 'image/jpeg',\n  WEBP: 'image/webp',\n  BMP: 'image/bmp'\n};\nvar maxSteps = 4;\nvar scaleFactor = Math.log(2);\nvar supportMimeTypes = Object.keys(mimeTypes).map(function (type) {\n  return mimeTypes[type];\n});\nvar defaultType = mimeTypes.JPEG;\nfunction isSupportedType(type) {\n  return supportMimeTypes.includes(type);\n}\nvar Compress = /** @class */function () {\n  function Compress(file, config) {\n    this.file = file;\n    this.config = config;\n    this.config = __assign({\n      quality: 0.92,\n      noCompressIfLarger: false\n    }, this.config);\n  }\n  Compress.prototype.process = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var srcDimension, originImage, canvas, scale, scaleCanvas, distBlob;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            this.outputType = this.file.type;\n            srcDimension = {};\n            if (!isSupportedType(this.file.type)) {\n              throw new QiniuError(QiniuErrorName.UnsupportedFileType, \"unsupported file type: \" + this.file.type);\n            }\n            return [4 /*yield*/, this.getOriginImage()];\n          case 1:\n            originImage = _a.sent();\n            return [4 /*yield*/, this.getCanvas(originImage)];\n          case 2:\n            canvas = _a.sent();\n            scale = 1;\n            if (this.config.maxWidth) {\n              scale = Math.min(1, this.config.maxWidth / canvas.width);\n            }\n            if (this.config.maxHeight) {\n              scale = Math.min(1, scale, this.config.maxHeight / canvas.height);\n            }\n            srcDimension.width = canvas.width;\n            srcDimension.height = canvas.height;\n            return [4 /*yield*/, this.doScale(canvas, scale)];\n          case 3:\n            scaleCanvas = _a.sent();\n            distBlob = this.toBlob(scaleCanvas);\n            if (distBlob.size > this.file.size && this.config.noCompressIfLarger) {\n              return [2 /*return*/, {\n                dist: this.file,\n                width: srcDimension.width,\n                height: srcDimension.height\n              }];\n            }\n            return [2 /*return*/, {\n              dist: distBlob,\n              width: scaleCanvas.width,\n              height: scaleCanvas.height\n            }];\n        }\n      });\n    });\n  };\n  Compress.prototype.clear = function (ctx, width, height) {\n    // jpeg 没有 alpha 通道，透明区间会被填充成黑色，这里把透明区间填充为白色\n    if (this.outputType === defaultType) {\n      ctx.fillStyle = '#fff';\n      ctx.fillRect(0, 0, width, height);\n    } else {\n      ctx.clearRect(0, 0, width, height);\n    }\n  };\n  /** 通过 file 初始化 image 对象 */\n  Compress.prototype.getOriginImage = function () {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      var url = createObjectURL(_this.file);\n      var img = new Image();\n      img.onload = function () {\n        resolve(img);\n      };\n      img.onerror = function () {\n        reject('image load error');\n      };\n      img.src = url;\n    });\n  };\n  Compress.prototype.getCanvas = function (img) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      var canvas = document.createElement('canvas');\n      var context = canvas.getContext('2d');\n      if (!context) {\n        reject(new QiniuError(QiniuErrorName.GetCanvasContextFailed, 'context is null'));\n        return;\n      }\n      var width = img.width,\n        height = img.height;\n      canvas.height = height;\n      canvas.width = width;\n      _this.clear(context, width, height);\n      context.drawImage(img, 0, 0);\n      resolve(canvas);\n    });\n  };\n  Compress.prototype.doScale = function (source, scale) {\n    return __awaiter(this, void 0, void 0, function () {\n      var sctx, steps, factor, mirror, mctx, width, height, originWidth, originHeight, src, context, i, dw, dh, canvas, data;\n      return __generator(this, function (_a) {\n        if (scale === 1) {\n          return [2 /*return*/, source];\n        }\n        sctx = source.getContext('2d');\n        steps = Math.min(maxSteps, Math.ceil(1 / scale / scaleFactor));\n        factor = Math.pow(scale, 1 / steps);\n        mirror = document.createElement('canvas');\n        mctx = mirror.getContext('2d');\n        width = source.width, height = source.height;\n        originWidth = width;\n        originHeight = height;\n        mirror.width = width;\n        mirror.height = height;\n        if (!mctx || !sctx) {\n          throw new QiniuError(QiniuErrorName.GetCanvasContextFailed, \"mctx or sctx can't be null\");\n        }\n        for (i = 0; i < steps; i++) {\n          dw = width * factor | 0 // eslint-disable-line no-bitwise\n          ;\n          dh = height * factor | 0 // eslint-disable-line no-bitwise\n          ;\n          // 到最后一步的时候 dw, dh 用目标缩放尺寸，否则会出现最后尺寸偏小的情况\n          if (i === steps - 1) {\n            dw = originWidth * scale;\n            dh = originHeight * scale;\n          }\n          if (i % 2 === 0) {\n            src = source;\n            context = mctx;\n          } else {\n            src = mirror;\n            context = sctx;\n          }\n          // 每次画前都清空，避免图像重叠\n          this.clear(context, width, height);\n          context.drawImage(src, 0, 0, width, height, 0, 0, dw, dh);\n          width = dw;\n          height = dh;\n        }\n        canvas = src === source ? mirror : source;\n        data = context.getImageData(0, 0, width, height);\n        // resize\n        canvas.width = width;\n        canvas.height = height;\n        // store image data\n        context.putImageData(data, 0, 0);\n        return [2 /*return*/, canvas];\n      });\n    });\n  };\n  /** 这里把 base64 字符串转为 blob 对象 */\n  Compress.prototype.toBlob = function (result) {\n    var dataURL = result.toDataURL(this.outputType, this.config.quality);\n    var buffer = atob(dataURL.split(',')[1]).split('').map(function (_char) {\n      return _char.charCodeAt(0);\n    });\n    var blob = new Blob([new Uint8Array(buffer)], {\n      type: this.outputType\n    });\n    return blob;\n  };\n  return Compress;\n}();\nvar compressImage = function compressImage(file, options) {\n  return new Compress(file, options).process();\n};\nexport default compressImage;","map":{"version":3,"names":["QiniuErrorName","QiniuError","createObjectURL","mimeTypes","PNG","JPEG","WEBP","BMP","maxSteps","scaleFactor","Math","log","supportMimeTypes","Object","keys","map","type","defaultType","isSupportedType","includes","Compress","file","config","__assign","quality","noCompressIfLarger","prototype","process","outputType","srcDimension","UnsupportedFileType","getOriginImage","originImage","_a","sent","getCanvas","canvas","scale","maxWidth","min","width","maxHeight","height","doScale","scaleCanvas","distBlob","toBlob","size","dist","clear","ctx","fillStyle","fillRect","clearRect","_this","Promise","resolve","reject","url","img","Image","onload","onerror","src","document","createElement","context","getContext","GetCanvasContextFailed","drawImage","source","sctx","steps","ceil","factor","pow","mirror","mctx","originWidth","originHeight","i","dw","dh","data","getImageData","putImageData","result","dataURL","toDataURL","buffer","atob","split","char","charCodeAt","blob","Blob","Uint8Array","compressImage","options"],"sources":["../../src/utils/compress.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
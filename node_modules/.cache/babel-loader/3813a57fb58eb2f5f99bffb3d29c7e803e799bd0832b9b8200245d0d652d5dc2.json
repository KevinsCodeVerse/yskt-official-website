{"ast":null,"code":"import \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.error.to-string.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.array-buffer.constructor.js\";\nimport \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.data-view.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.function.bind.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/es.typed-array.uint8-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.find-last.js\";\nimport \"core-js/modules/es.typed-array.find-last-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.subarray.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n/* eslint-disable no-bitwise */\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n      label: 0,\n      sent: function sent() {\n        if (t[0] & 1) throw t[1];\n        return t[1];\n      },\n      trys: [],\n      ops: []\n    },\n    f,\n    y,\n    t,\n    g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n        case 7:\n          op = _.ops.pop();\n          _.trys.pop();\n          continue;\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n            _.ops.push(op);\n            break;\n          }\n          if (t[2]) _.ops.pop();\n          _.trys.pop();\n          continue;\n      }\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\nimport { MB } from './helper';\n/**\n * 以下 class 实现参考\n * https://github.com/Stuk/jszip/blob/d4702a70834bd953d4c2d0bc155fad795076631a/lib/crc32.js\n * 该实现主要针对大文件优化、对计算的值进行了 `>>> 0` 运算（为与服务端保持一致）\n */\nvar CRC32 = /** @class */function () {\n  function CRC32() {\n    this.crc = -1;\n    this.table = this.makeTable();\n  }\n  CRC32.prototype.makeTable = function () {\n    var table = new Array();\n    for (var i = 0; i < 256; i++) {\n      var t = i;\n      for (var j = 0; j < 8; j++) {\n        if (t & 1) {\n          // IEEE 标准\n          t = t >>> 1 ^ 0xEDB88320;\n        } else {\n          t >>>= 1;\n        }\n      }\n      table[i] = t;\n    }\n    return table;\n  };\n  CRC32.prototype.append = function (data) {\n    var crc = this.crc;\n    for (var offset = 0; offset < data.byteLength; offset++) {\n      crc = crc >>> 8 ^ this.table[(crc ^ data[offset]) & 0xFF];\n    }\n    this.crc = crc;\n  };\n  CRC32.prototype.compute = function () {\n    return (this.crc ^ -1) >>> 0;\n  };\n  CRC32.prototype.readAsUint8Array = function (file) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!(typeof file.arrayBuffer === 'function')) return [3 /*break*/, 2];\n            _a = Uint8Array.bind;\n            return [4 /*yield*/, file.arrayBuffer()];\n          case 1:\n            return [2 /*return*/, new (_a.apply(Uint8Array, [void 0, _b.sent()]))()];\n          case 2:\n            return [2 /*return*/, new Promise(function (resolve, reject) {\n              var reader = new FileReader();\n              reader.onload = function () {\n                if (reader.result == null) {\n                  reject();\n                  return;\n                }\n                if (typeof reader.result === 'string') {\n                  reject();\n                  return;\n                }\n                resolve(new Uint8Array(reader.result));\n              };\n              reader.readAsArrayBuffer(file);\n            })];\n        }\n      });\n    });\n  };\n  CRC32.prototype.file = function (file) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, count, index, start, end, chuck;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!(file.size <= MB)) return [3 /*break*/, 2];\n            _a = this.append;\n            return [4 /*yield*/, this.readAsUint8Array(file)];\n          case 1:\n            _a.apply(this, [_b.sent()]);\n            return [2 /*return*/, this.compute()];\n          case 2:\n            count = Math.ceil(file.size / MB);\n            index = 0;\n            _b.label = 3;\n          case 3:\n            if (!(index < count)) return [3 /*break*/, 6];\n            start = index * MB;\n            end = index === count - 1 ? file.size : start + MB;\n            return [4 /*yield*/, this.readAsUint8Array(file.slice(start, end))];\n          case 4:\n            chuck = _b.sent();\n            this.append(new Uint8Array(chuck));\n            _b.label = 5;\n          case 5:\n            index++;\n            return [3 /*break*/, 3];\n          case 6:\n            return [2 /*return*/, this.compute()];\n        }\n      });\n    });\n  };\n  CRC32.file = function (file) {\n    var crc = new CRC32();\n    return crc.file(file);\n  };\n  return CRC32;\n}();\nexport { CRC32 };","map":{"version":3,"names":["MB","CRC32","crc","table","makeTable","prototype","Array","i","t","j","append","data","offset","byteLength","compute","readAsUint8Array","file","arrayBuffer","Uint8Array","bind","_a","apply","_b","sent","Promise","resolve","reject","reader","FileReader","onload","result","readAsArrayBuffer","size","count","Math","ceil","index","start","end","slice","chuck"],"sources":["../../src/utils/crc32.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAASA,EAAE,QAAQ,UAAU;AAE7B;;;;;AAKA,IAAAC,KAAA;EAAA,SAAAA,MAAA;IACU,KAAAC,GAAG,GAAG,CAAC,CAAC;IACR,KAAAC,KAAK,GAAG,IAAI,CAACC,SAAS,EAAE;EA8ElC;EA5EUH,KAAA,CAAAI,SAAA,CAAAD,SAAS,GAAjB;IACE,IAAMD,KAAK,GAAG,IAAIG,KAAK,EAAU;IACjC,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,GAAG,EAAEA,CAAC,EAAE,EAAE;MAC5B,IAAIC,CAAC,GAAGD,CAAC;MACT,KAAK,IAAIE,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;QAC1B,IAAID,CAAC,GAAG,CAAC,EAAE;UACT;UACAA,CAAC,GAAIA,CAAC,KAAK,CAAC,GAAI,UAAU;SAC3B,MAAM;UACLA,CAAC,MAAM,CAAC;;;MAGZL,KAAK,CAACI,CAAC,CAAC,GAAGC,CAAC;;IAGd,OAAOL,KAAK;EACd,CAAC;EAEOF,KAAA,CAAAI,SAAA,CAAAK,MAAM,GAAd,UAAeC,IAAgB;IAC7B,IAAIT,GAAG,GAAG,IAAI,CAACA,GAAG;IAClB,KAAK,IAAIU,MAAM,GAAG,CAAC,EAAEA,MAAM,GAAGD,IAAI,CAACE,UAAU,EAAED,MAAM,EAAE,EAAE;MACvDV,GAAG,GAAIA,GAAG,KAAK,CAAC,GAAI,IAAI,CAACC,KAAK,CAAC,CAACD,GAAG,GAAGS,IAAI,CAACC,MAAM,CAAC,IAAI,IAAI,CAAC;;IAE7D,IAAI,CAACV,GAAG,GAAGA,GAAG;EAChB,CAAC;EAEOD,KAAA,CAAAI,SAAA,CAAAS,OAAO,GAAf;IACE,OAAO,CAAC,IAAI,CAACZ,GAAG,GAAG,CAAC,CAAC,MAAM,CAAC;EAC9B,CAAC;EAEaD,KAAA,CAAAI,SAAA,CAAAU,gBAAgB,GAA9B,UAA+BC,IAAiB;;;;;;kBAC1C,OAAOA,IAAI,CAACC,WAAW,KAAK,UAAU,GAAtC;iBACSC,UAAU,CAAAC,IAAA;YAAC,qBAAMH,IAAI,CAACC,WAAW,EAAE;;YAA9C,sBAAO,KAAAG,EAAA,CAAAC,KAAA,CAAIH,UAAU,WAACI,EAAA,CAAAC,IAAA,EAAwB,KAAC;;YAGjD,sBAAO,IAAIC,OAAO,CAAC,UAACC,OAAO,EAAEC,MAAM;cACjC,IAAMC,MAAM,GAAG,IAAIC,UAAU,EAAE;cAC/BD,MAAM,CAACE,MAAM,GAAG;gBACd,IAAIF,MAAM,CAACG,MAAM,IAAI,IAAI,EAAE;kBACzBJ,MAAM,EAAE;kBACR;;gBAGF,IAAI,OAAOC,MAAM,CAACG,MAAM,KAAK,QAAQ,EAAE;kBACrCJ,MAAM,EAAE;kBACR;;gBAGFD,OAAO,CAAC,IAAIP,UAAU,CAACS,MAAM,CAACG,MAAM,CAAC,CAAC;cACxC,CAAC;cACDH,MAAM,CAACI,iBAAiB,CAACf,IAAI,CAAC;YAChC,CAAC,CAAC;;;;GACH;EAEKf,KAAA,CAAAI,SAAA,CAAAW,IAAI,GAAV,UAAWA,IAAU;;;;;;kBACfA,IAAI,CAACgB,IAAI,IAAIhC,EAAE,GAAf;YACFoB,EAAA,OAAI,CAACV,MAAM;YAAC,qBAAM,IAAI,CAACK,gBAAgB,CAACC,IAAI,CAAC;;YAA7CI,EAAA,CAAAC,KAAA,KAAI,GAAQC,EAAA,CAAAC,IAAA,EAAiC,EAAC;YAC9C,sBAAO,IAAI,CAACT,OAAO,EAAE;;YAGjBmB,KAAK,GAAGC,IAAI,CAACC,IAAI,CAACnB,IAAI,CAACgB,IAAI,GAAGhC,EAAE,CAAC;YAC9BoC,KAAK,GAAG,CAAC;;;kBAAEA,KAAK,GAAGH,KAAK;YACzBI,KAAK,GAAGD,KAAK,GAAGpC,EAAE;YAClBsC,GAAG,GAAGF,KAAK,KAAMH,KAAK,GAAG,CAAE,GAAGjB,IAAI,CAACgB,IAAI,GAAGK,KAAK,GAAGrC,EAAE;YAE5C,qBAAM,IAAI,CAACe,gBAAgB,CAACC,IAAI,CAACuB,KAAK,CAACF,KAAK,EAAEC,GAAG,CAAC,CAAC;;YAA3DE,KAAK,GAAGlB,EAAA,CAAAC,IAAA,EAAmD;YACjE,IAAI,CAACb,MAAM,CAAC,IAAIQ,UAAU,CAACsB,KAAK,CAAC,CAAC;;;YALDJ,KAAK,EAAE;;;YAQ1C,sBAAO,IAAI,CAACtB,OAAO,EAAE;;;;GACtB;EAEMb,KAAA,CAAAe,IAAI,GAAX,UAAYA,IAAU;IACpB,IAAMd,GAAG,GAAG,IAAID,KAAK,EAAE;IACvB,OAAOC,GAAG,CAACc,IAAI,CAACA,IAAI,CAAC;EACvB,CAAC;EACH,OAAAf,KAAC;AAAD,CAAC,CAhFD","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _regeneratorRuntime from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _objectSpread from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nimport _asyncToGenerator from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nvar _excluded = [\"work\", \"url\"];\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.date.to-json.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport uploadImage from \"@/components/uploadImage.vue\";\nimport { getCourseWorkList, submitWork } from \"@/common/api/user\";\nexport default {\n  name: \"addCourseWork\",\n  components: {\n    uploadImage: uploadImage\n  },\n  data: function data() {\n    return {\n      addModifyVisible: false,\n      dialogTitle: \"\",\n      chapterIdOptions: [],\n      workOptions: [],\n      addData: {\n        chapterId: \"\",\n        courseId: \"\",\n        name: \"\",\n        url: \"\",\n        work: \"\"\n      },\n      workRule: {\n        work: [{\n          required: true,\n          message: \"请选择作业\",\n          trigger: \"blur\"\n        }],\n        url: [{\n          required: true,\n          message: \"请上传作业图片\",\n          trigger: \"blur\"\n        }],\n        name: [{\n          required: true,\n          message: \"请输入作业描述\",\n          trigger: \"blur\"\n        }]\n      }\n    };\n  },\n  created: function created() {},\n  mounted: function mounted() {},\n  methods: {\n    edit: function edit(id) {\n      this.dialogTitle = \"提交作业\";\n      this.addData.courseId = id;\n      // this.chapterIdOptions = row.adCourseChapters;\n      this.addModifyVisible = true;\n      this.getWorkList(id);\n    },\n    close: function close() {\n      this.$refs.workRef && this.$refs.workRef.clearValidate();\n      this.addData = {\n        chapterId: \"\",\n        courseId: \"\",\n        name: \"\",\n        url: \"\",\n        work: \"\"\n      };\n      this.addModifyVisible = false;\n    },\n    handleSubmit: function handleSubmit() {\n      var _this = this;\n      this.$refs.workRef.validate(/*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(valid) {\n          var _this$addData, work, url, rest, res;\n          return _regeneratorRuntime().wrap(function _callee$(_context) {\n            while (1) switch (_context.prev = _context.next) {\n              case 0:\n                if (!valid) {\n                  _context.next = 6;\n                  break;\n                }\n                _this$addData = _this.addData, work = _this$addData.work, url = _this$addData.url, rest = _objectWithoutProperties(_this$addData, _excluded);\n                _context.next = 4;\n                return submitWork(_objectSpread(_objectSpread({\n                  workId: work.id,\n                  url: url ? JSON.stringify(url.map(function (item) {\n                    return item.url;\n                  })) : \"\"\n                }, rest), {}, {\n                  chapterId: work.chapterId\n                }));\n              case 4:\n                res = _context.sent;\n                if (res) {\n                  _this.$message.success(\"提交成功\");\n                  _this.addModifyVisible = false;\n                }\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }, _callee);\n        }));\n        return function (_x) {\n          return _ref.apply(this, arguments);\n        };\n      }());\n    },\n    getChapterList: function getChapterList() {},\n    getWorkList: function getWorkList(courseId) {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var res;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return getCourseWorkList({\n                courseId: courseId\n              });\n            case 2:\n              res = _context2.sent;\n              _this2.workOptions = res.result;\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["uploadImage","getCourseWorkList","submitWork","name","components","data","addModifyVisible","dialogTitle","chapterIdOptions","workOptions","addData","chapterId","courseId","url","work","workRule","required","message","trigger","created","mounted","methods","edit","id","getWorkList","close","$refs","workRef","clearValidate","handleSubmit","_this","validate","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","valid","_this$addData","rest","res","wrap","_callee$","_context","prev","next","_objectWithoutProperties","_excluded","_objectSpread","workId","JSON","stringify","map","item","sent","$message","success","stop","_x","apply","arguments","getChapterList","_this2","_callee2","_callee2$","_context2","result"],"sources":["src/components/submitWork.vue"],"sourcesContent":["<!-- 布置作业 -->\n<template>\n  <div>\n    <el-dialog\n      :title=\"dialogTitle\"\n      :close-on-click-modal=\"false\"\n      :visible.sync=\"addModifyVisible\"\n      :append-to-body=\"true\"\n      width=\"40%\"\n      @close=\"close\"\n    >\n      <el-form\n        :model=\"addData\"\n        :rules=\"workRule\"\n        ref=\"workRef\"\n        size=\"small\"\n        label-position=\"left\"\n        label-width=\"120px\"\n      >\n        <el-form-item label=\"作业\" prop=\"work\">\n          <el-select\n            style=\"width: 100%\"\n            v-model=\"addData.work\"\n            placeholder=\"请选择课作业\"\n            value-key=\"id\"\n            clearable\n            filterable\n          >\n            <el-option\n              v-for=\"item in workOptions\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item\"\n            >\n            </el-option>\n          </el-select>\n        </el-form-item>\n\n        <el-form-item label=\"作业图片:\" prop=\"url\">\n          <upload-image v-model=\"addData.url\" :limit=\"5\"></upload-image>\n        </el-form-item>\n        <el-form-item label=\"作业描述:\" prop=\"name\">\n          <el-input\n            type=\"textarea\"\n            :rows=\"5\"\n            v-model=\"addData.name\"\n            placeholder=\"请输入作业描述\"\n          ></el-input>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button size=\"small\" plain @click=\"close\">取 消</el-button>\n        <el-button size=\"small\" type=\"primary\" @click=\"handleSubmit\"\n          >确 定</el-button\n        >\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport uploadImage from \"@/components/uploadImage.vue\";\nimport { getCourseWorkList, submitWork } from \"@/common/api/user\";\nexport default {\n  name: \"addCourseWork\",\n  components: { uploadImage },\n  data() {\n    return {\n      addModifyVisible: false,\n      dialogTitle: \"\",\n      chapterIdOptions: [],\n      workOptions: [],\n      addData: {\n        chapterId: \"\",\n        courseId: \"\",\n        name: \"\",\n        url: \"\",\n        work: \"\",\n      },\n      workRule: {\n        work: [{ required: true, message: \"请选择作业\", trigger: \"blur\" }],\n        url: [{ required: true, message: \"请上传作业图片\", trigger: \"blur\" }],\n        name: [{ required: true, message: \"请输入作业描述\", trigger: \"blur\" }],\n      },\n    };\n  },\n\n  created() {},\n\n  mounted() {},\n\n  methods: {\n    edit(id) {\n      this.dialogTitle = \"提交作业\";\n      this.addData.courseId = id;\n      // this.chapterIdOptions = row.adCourseChapters;\n      this.addModifyVisible = true;\n      this.getWorkList(id);\n    },\n\n    close() {\n      this.$refs.workRef && this.$refs.workRef.clearValidate();\n      this.addData = {\n        chapterId: \"\",\n        courseId: \"\",\n        name: \"\",\n        url: \"\",\n        work: \"\",\n      };\n      this.addModifyVisible = false;\n    },\n\n    handleSubmit() {\n      this.$refs.workRef.validate(async (valid) => {\n        if (valid) {\n          const { work,url, ...rest } = this.addData;\n          const res = await submitWork({\n            workId: work.id,\n            url: url  ? JSON.stringify(url.map(item => item.url)) : \"\",\n            ...rest,\n            chapterId: work.chapterId,\n          });\n          if (res) {\n            this.$message.success(\"提交成功\");\n            this.addModifyVisible = false;\n          }\n        }\n      });\n    },\n\n    getChapterList() {},\n    async getWorkList(courseId) {\n      const res = await getCourseWorkList({ courseId });\n      this.workOptions = res.result;\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped></style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _regeneratorRuntime from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _toConsumableArray from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _asyncToGenerator from \"/Users/fjw/Desktop/yskt/yskt-official-website/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport { getWorkCircleApi } from \"@/common/api/user\";\nexport default {\n  data: function data() {\n    return {\n      params: {\n        pageNo: 1,\n        pageSize: 10\n      },\n      total: 0,\n      courseList: [],\n      loading: false,\n      pageNo: 1,\n      pageSize: 10,\n      noMore: false // 增加 noMore 标志\n    };\n  },\n  created: function created() {\n    this.getCourseList();\n  },\n  computed: {\n    disabled: function disabled() {\n      return this.loading || this.noMore; // 当 loading 或者没有更多内容时，禁用加载\n    }\n  },\n  methods: {\n    getCourseList: function getCourseList() {\n      var _arguments = arguments,\n        _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var load, res, _res$result, list, total;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              load = _arguments.length > 0 && _arguments[0] !== undefined ? _arguments[0] : false;\n              if (!(_this.loading || _this.noMore)) {\n                _context.next = 3;\n                break;\n              }\n              return _context.abrupt(\"return\");\n            case 3:\n              // 防止重复加载\n              _this.loading = true;\n              _this.params.pageNo = _this.pageNo;\n              _context.prev = 5;\n              _context.next = 8;\n              return getWorkCircleApi(_this.params);\n            case 8:\n              res = _context.sent;\n              if (res && res.result) {\n                _res$result = res.result, list = _res$result.list, total = _res$result.total;\n                if (load) {\n                  _this.courseList = [].concat(_toConsumableArray(_this.courseList), _toConsumableArray(list));\n                } else {\n                  _this.courseList = list;\n                }\n                _this.total = total;\n\n                // 判断是否加载完所有数据\n                if (_this.courseList.length >= total) {\n                  _this.noMore = true; // 设置 noMore，表示没有更多数据\n                }\n              }\n              _context.next = 15;\n              break;\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](5);\n              console.error(\"加载课程列表出错:\", _context.t0);\n            case 15:\n              _context.prev = 15;\n              _this.loading = false;\n              return _context.finish(15);\n            case 18:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, null, [[5, 12, 15, 18]]);\n      }))();\n    },\n    loadMore: function loadMore() {\n      if (!this.noMore && !this.loading) {\n        this.pageNo++;\n        this.getCourseList(true); // 加载下一页数据\n      }\n    },\n    handleItemClick: function handleItemClick(item) {\n      console.log(item, \"item\");\n    },\n    parseUrls: function parseUrls(urlString) {\n      try {\n        return JSON.parse(urlString);\n      } catch (e) {\n        console.error(\"Invalid URL format\", e);\n        return [];\n      }\n    }\n  }\n};","map":{"version":3,"names":["getWorkCircleApi","data","params","pageNo","pageSize","total","courseList","loading","noMore","created","getCourseList","computed","disabled","methods","_arguments","arguments","_this","_asyncToGenerator","_regeneratorRuntime","mark","_callee","load","res","_res$result","list","wrap","_callee$","_context","prev","next","length","undefined","abrupt","sent","result","concat","_toConsumableArray","t0","console","error","finish","stop","loadMore","handleItemClick","item","log","parseUrls","urlString","JSON","parse","e"],"sources":["src/views/homeWorkCircle/operationSquare.vue"],"sourcesContent":["<template>\n  <div>\n    <div class=\"myCourse\">\n      <div\n          class=\"content-box\"\n          v-infinite-scroll=\"loadMore\"\n          infinite-scroll-disabled=\"disabled\"\n          infinite-scroll-distance=\"50\"\n      >\n        <div\n            v-for=\"(item, index) in courseList\"\n            :key=\"index\"\n            class=\"content-item\"\n            @click=\"handleItemClick(item)\"\n        >\n          <!-- 左侧的头像和用户信息 -->\n          <div class=\"avatar-box\">\n            <img class=\"avatar\" :src=\"item.avatar\" alt=\"avatar\" />\n          </div>\n\n          <!-- 右侧的内容区域 -->\n          <div class=\"content-info\">\n            <h3 class=\"name\">{{ item.name }}</h3>\n            <p class=\"chapter\">章节: {{ item.chapterName }}</p>\n            <p class=\"comment\">评论: {{ item.comment }}</p>\n            <p class=\"time\">时间: {{ item.time }}</p>\n\n            <!-- 图片展示 -->\n            <div v-if=\"item.url && parseUrls(item.url).length\" class=\"image-box\">\n              <img\n                  v-for=\"(url, i) in parseUrls(item.url)\"\n                  :key=\"i\"\n                  class=\"image\"\n                  :src=\"url\"\n                  alt=\"related image\"\n              />\n            </div>\n          </div>\n        </div>\n        <div class=\"bottom-info\" v-if=\"loading\">加载中...</div>\n        <div class=\"bottom-info\" v-if=\"noMore\">没有更多了</div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { getWorkCircleApi } from \"@/common/api/user\";\n\nexport default {\n  data() {\n    return {\n      params: {\n        pageNo: 1,\n        pageSize: 10,\n      },\n      total: 0,\n      courseList: [],\n      loading: false,\n      pageNo: 1,\n      pageSize: 10,\n      noMore: false,  // 增加 noMore 标志\n    };\n  },\n  created() {\n    this.getCourseList();\n  },\n  computed: {\n    disabled() {\n      return this.loading || this.noMore; // 当 loading 或者没有更多内容时，禁用加载\n    },\n  },\n  methods: {\n    async getCourseList(load = false) {\n      if (this.loading || this.noMore) return;  // 防止重复加载\n      this.loading = true;\n\n      this.params.pageNo = this.pageNo;\n      try {\n        const res = await getWorkCircleApi(this.params);\n        if (res && res.result) {\n          const { list, total } = res.result;\n\n          if (load) {\n            this.courseList = [...this.courseList, ...list];\n          } else {\n            this.courseList = list;\n          }\n\n          this.total = total;\n\n          // 判断是否加载完所有数据\n          if (this.courseList.length >= total) {\n            this.noMore = true;  // 设置 noMore，表示没有更多数据\n          }\n        }\n      } catch (error) {\n        console.error(\"加载课程列表出错:\", error);\n      } finally {\n        this.loading = false;\n      }\n    },\n    loadMore() {\n      if (!this.noMore && !this.loading) {\n        this.pageNo++;\n        this.getCourseList(true);  // 加载下一页数据\n      }\n    },\n    handleItemClick(item) {\n      console.log(item, \"item\");\n    },\n    parseUrls(urlString) {\n      try {\n        return JSON.parse(urlString);\n      } catch (e) {\n        console.error(\"Invalid URL format\", e);\n        return [];\n      }\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n.myCourse {\n  max-width: 1000px;\n  margin: 40px auto;\n  padding: 0;\n  box-sizing: border-box;\n  height: 500px; /* 确保有固定高度，才会出现滚动条 */\n  overflow: auto; /* 当内容超出时出现滚动条 */\n}\n\n.content-box {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.content-item {\n  display: flex;\n  background: #fff;\n  border-radius: 10px;\n  padding: 20px;\n  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\n  transition: all 0.3s ease;\n  cursor: pointer;\n  align-items: center;\n\n  &:hover {\n    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);\n  }\n\n  .avatar-box {\n    margin-right: 20px;\n    .avatar {\n      width: 80px;\n      height: 80px;\n      border-radius: 50%;\n      object-fit: cover;\n      border: 2px solid #f0f0f0;\n    }\n  }\n\n  .content-info {\n    flex-grow: 1;\n\n    .name {\n      font-size: 20px;\n      font-weight: bold;\n      color: #333;\n      margin-bottom: 8px;\n    }\n\n    .chapter,\n    .comment,\n    .time {\n      font-size: 14px;\n      color: #666;\n      margin-bottom: 4px;\n    }\n\n    .image-box {\n      margin-top: 10px;\n      display: flex;\n      gap: 10px;\n\n      .image {\n        width: 80px;\n        height: 80px;\n        border-radius: 8px;\n        object-fit: cover;\n        transition: transform 0.3s ease;\n        border: 1px solid #f0f0f0;\n      }\n\n      .image:hover {\n        transform: scale(1.05);\n      }\n    }\n  }\n}\n\n.bottom-info {\n  text-align: center;\n  margin: 20px 0;\n  color: #999;\n  font-size: 14px;\n}\n</style>\n"],"mappings":";;;;;AA+CA,SAAAA,gBAAA;AAEA;EACAC,IAAA,WAAAA,KAAA;IACA;MACAC,MAAA;QACAC,MAAA;QACAC,QAAA;MACA;MACAC,KAAA;MACAC,UAAA;MACAC,OAAA;MACAJ,MAAA;MACAC,QAAA;MACAI,MAAA;IACA;EACA;EACAC,OAAA,WAAAA,QAAA;IACA,KAAAC,aAAA;EACA;EACAC,QAAA;IACAC,QAAA,WAAAA,SAAA;MACA,YAAAL,OAAA,SAAAC,MAAA;IACA;EACA;EACAK,OAAA;IACAH,aAAA,WAAAA,cAAA;MAAA,IAAAI,UAAA,GAAAC,SAAA;QAAAC,KAAA;MAAA,OAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,UAAAC,QAAA;QAAA,IAAAC,IAAA,EAAAC,GAAA,EAAAC,WAAA,EAAAC,IAAA,EAAAnB,KAAA;QAAA,OAAAa,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA;UAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;YAAA;cAAAR,IAAA,GAAAP,UAAA,CAAAgB,MAAA,QAAAhB,UAAA,QAAAiB,SAAA,GAAAjB,UAAA;cAAA,MACAE,KAAA,CAAAT,OAAA,IAAAS,KAAA,CAAAR,MAAA;gBAAAmB,QAAA,CAAAE,IAAA;gBAAA;cAAA;cAAA,OAAAF,QAAA,CAAAK,MAAA;YAAA;cAAA;cACAhB,KAAA,CAAAT,OAAA;cAEAS,KAAA,CAAAd,MAAA,CAAAC,MAAA,GAAAa,KAAA,CAAAb,MAAA;cAAAwB,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAE,IAAA;cAAA,OAEA7B,gBAAA,CAAAgB,KAAA,CAAAd,MAAA;YAAA;cAAAoB,GAAA,GAAAK,QAAA,CAAAM,IAAA;cACA,IAAAX,GAAA,IAAAA,GAAA,CAAAY,MAAA;gBAAAX,WAAA,GACAD,GAAA,CAAAY,MAAA,EAAAV,IAAA,GAAAD,WAAA,CAAAC,IAAA,EAAAnB,KAAA,GAAAkB,WAAA,CAAAlB,KAAA;gBAEA,IAAAgB,IAAA;kBACAL,KAAA,CAAAV,UAAA,MAAA6B,MAAA,CAAAC,kBAAA,CAAApB,KAAA,CAAAV,UAAA,GAAA8B,kBAAA,CAAAZ,IAAA;gBACA;kBACAR,KAAA,CAAAV,UAAA,GAAAkB,IAAA;gBACA;gBAEAR,KAAA,CAAAX,KAAA,GAAAA,KAAA;;gBAEA;gBACA,IAAAW,KAAA,CAAAV,UAAA,CAAAwB,MAAA,IAAAzB,KAAA;kBACAW,KAAA,CAAAR,MAAA;gBACA;cACA;cAAAmB,QAAA,CAAAE,IAAA;cAAA;YAAA;cAAAF,QAAA,CAAAC,IAAA;cAAAD,QAAA,CAAAU,EAAA,GAAAV,QAAA;cAEAW,OAAA,CAAAC,KAAA,cAAAZ,QAAA,CAAAU,EAAA;YAAA;cAAAV,QAAA,CAAAC,IAAA;cAEAZ,KAAA,CAAAT,OAAA;cAAA,OAAAoB,QAAA,CAAAa,MAAA;YAAA;YAAA;cAAA,OAAAb,QAAA,CAAAc,IAAA;UAAA;QAAA,GAAArB,OAAA;MAAA;IAEA;IACAsB,QAAA,WAAAA,SAAA;MACA,UAAAlC,MAAA,UAAAD,OAAA;QACA,KAAAJ,MAAA;QACA,KAAAO,aAAA;MACA;IACA;IACAiC,eAAA,WAAAA,gBAAAC,IAAA;MACAN,OAAA,CAAAO,GAAA,CAAAD,IAAA;IACA;IACAE,SAAA,WAAAA,UAAAC,SAAA;MACA;QACA,OAAAC,IAAA,CAAAC,KAAA,CAAAF,SAAA;MACA,SAAAG,CAAA;QACAZ,OAAA,CAAAC,KAAA,uBAAAW,CAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}